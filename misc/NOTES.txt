Working on coversion of this to C# and intergrating with CNCinfusion